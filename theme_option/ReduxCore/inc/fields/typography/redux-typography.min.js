!function(O){"use strict";var I=[],B=!1,P=!0;redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{},redux.field_objects.typography.init=function(e){e=e||O(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible"),O(e).each(function(){var u=O(this),e=u;u.hasClass("redux-field-container")||(e=u.parents(".redux-field-container:first")),e.is(":hidden")||(void 0===redux.field_objects.pro&&(P=!1),u.each(function(){O(this).find(".redux-typography-container").each(function(){var e,t,a,r,s,o,i=O(this).find(".redux-typography-family"),p=i.data("value"),d=O(this).find(".redux-typography-family").parents(".redux-container-typography:first").data("id"),n=O("#"+d+" .redux-typography-google").val(),y=O("#"+d).parent(),l=[],g=[],h=O("#"+d+" .redux-typography-font-family").data("user-fonts");if(y.hasClass("redux-field-init")){if(void 0===p?i=O(this):""!==p&&O(i).val(p),h=h?1:0,n=n?1:0,void 0!==redux.optName.customfonts&&l.push(redux.optName.customfonts),void 0!==redux.optName.typekitfonts&&l.push(redux.optName.typekitfonts),void 0!==redux.optName.stdfonts&&0===h&&l.push(redux.optName.stdfonts),1===h){for(e in redux.optName.typography[d])if(redux.optName.typography[d].hasOwnProperty(e))for(a in t=redux.optName.typography[d].std_font)t.hasOwnProperty(a)&&g.push({id:a,text:a,"data-google":"false"});r={text:"Standard Fonts",children:g},l.push(r)}(1===n||!0===n&&void 0!==redux.optName.googlefonts)&&l.push(redux.optName.googlefonts),o=l,s=O(this).find(".redux-typography-family").data("value"),O(this).find(".redux-typography-family").addClass("ignore-change"),O(this).find(".redux-typography-family").select2({data:o}),O(this).find(".redux-typography-family").val(s).trigger("change"),O(this).find(".redux-typography-family").removeClass("ignore-change"),u.find(".redux-typography-family").hasClass("redux-typography-family")||u.find(".redux-typography-style").select2(),O(this).find(".redux-typography-align").select2(),O(this).find(".redux-typography-family-backup").select2(),O(this).find(".redux-typography-transform").select2(),O(this).find(".redux-typography-font-variant").select2(),O(this).find(".redux-typography-decoration").select2(),redux.field_objects.typography.select(i,!0,!1,null,!0),O(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(e){var t,a,r=O(this).attr("id"),s=O("#"+r);O(this).hasClass("redux-typography-family")?s.val()&&(a=(t=O(this).select2("data"))?t[0].text:null,s.data("value",a),I=t[0],B=!0,redux.field_objects.typography.select(s,!0,!1,a,!0)):(e=s.val(),s.data("value",e),(O(this).hasClass("redux-typography-align")||O(this).hasClass("redux-typography-subsets")||O(this).hasClass("redux-typography-family-backup")||O(this).hasClass("redux-typography-transform")||O(this).hasClass("redux-typography-font-variant")||O(this).hasClass("redux-typography-decoration"))&&(s.find('option[selected="selected"]').removeAttr("selected"),s.find('option[value="'+e+'"]').attr("selected","selected")),O(this).hasClass("redux-typography-subsets")&&s.siblings(".typography-subsets").val(e),redux.field_objects.typography.select(O(this),!0,!1,null,!1))}),O(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(O(this).parents(".redux-container-typography:first"))}),P&&(redux.field_objects.pro.typography.fieldChange(O(this)),redux.field_objects.pro.typography.colorPicker(O(this))),O(this).find(".redux-typography-color").wpColorPicker({change:function(e,t){O(this).val(t.color.toString()),redux.field_objects.typography.select(O(this).parents(".redux-container-typography:first"))}}),O(this).find(".redux-typography-size").numeric({allowMinus:!1}),O(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),O(this).find(".redux-typography").on("select2:unselecting",function(){var e,t,a=O(this).data("select2").options;a.set("disabled",!0),setTimeout(function(){a.set("disabled",!1)},1),e=O(this).attr("id"),(t=O("#"+e)).data("value",""),O(this).hasClass("redux-typography-family")?(O(this).find(".redux-typography-family").addClass("ignore-change"),O(this).val(null).trigger("change"),O(this).find(".redux-typography-family").removeClass("ignore-change"),redux.field_objects.typography.select(t,!0,!1,null,!0)):((O(this).hasClass("redux-typography-align")||O(this).hasClass("redux-typography-subsets")||O(this).hasClass("redux-typography-family-backup")||O(this).hasClass("redux-typography-transform")||O(this).hasClass("redux-typography-font-variant")||O(this).hasClass("redux-typography-decoration"))&&O("#"+e+' option[selected="selected"]').removeAttr("selected"),O(this).hasClass("redux-typography-subsets")&&t.siblings(".typography-subsets").val(""),O(this).hasClass("redux-typography-family-backup")&&(O(this).find(".redux-typography-family-backup").addClass("ignore-change"),t.val(null).trigger("change"),O(this).find(".redux-typography-family-backup").removeClass("ignore-change")),redux.field_objects.typography.select(O(this),!0,!1,null,!1))}),redux.field_objects.typography.updates(O(this)),window.onbeforeunload=null,y.removeClass("redux-field-init")}})}))})},redux.field_objects.typography.updates=function(s){s.find(".update-google-fonts").bind("click",function(e){var a=O(this).data("action"),r=O(this).parent().parent(),t=r.attr("data-nonce");return r.find("p").text(redux_typography_ajax.update_google_fonts.updating),r.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.updating),r.removeClass("updating-message updated-message notice-success notice-warning notice-error").addClass("update-message notice-warning updating-message"),O.ajax({type:"post",dataType:"json",url:redux_typography_ajax.ajaxurl,data:{action:"redux_update_google_fonts",nonce:t,data:a},error:function(e){var t;console.log(e),r.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),t=(t=e.error)&&': "'+t+'"',r.find("p").html(redux_typography_ajax.update_google_fonts.error.replace("%s",a).replace("|msg",t)),r.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.error),redux.field_objects.typography.updates(s)},success:function(e){var t;console.log(e),"success"===e.status?(r.find("p").html(redux_typography_ajax.update_google_fonts.success),r.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.success),r.removeClass("updating-message notice-warning").addClass("updated-message notice-success"),O(".redux-update-google-fonts").not(".notice-success").remove()):(r.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),t=(t=e.error)&&': "'+t+'"',r.find("p").html(redux_typography_ajax.update_google_fonts.error.replace("%s",a).replace("|msg",t)),r.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.error),redux.field_objects.typography.updates(s))}}),e.preventDefault(),!1})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&(a+=1);return a},redux.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&!1!==e&&0!==e&&("true"===e||"1"===e||!0===e||1===e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";return""!==e&&(e=e.replace("#",""),t=128<=(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3?"#444444":"#ffffff"),t},redux.field_objects.typography.select=function(e,t,a,r,s){var o,i,p,d,n,y,l,g,h,u,f,c,x,v,m,b,_,C,j,w=!1,k="",N='<option value=""></option>',z="";void 0===(o=O(e).parents(".redux-container-typography:first").data("id"))&&(o=O(e).data("id")),i=O("#"+o),p=(p=O("#"+o+"-family").val())||null,r&&(p=r),n=i.find("select.redux-typography-family-backup").val(),y=i.find(".redux-typography-size").val(),l=i.find(".redux-typography-height").val(),g=i.find(".redux-typography-word").val(),h=i.find(".redux-typography-letter").val(),u=i.find("select.redux-typography-align").val(),f=i.find("select.redux-typography-transform").val(),c=i.find("select.redux-typography-font-variant").val(),x=i.find("select.redux-typography-decoration").val(),v=i.find("select.redux-typography-style").val(),m=i.find("select.redux-typography-subsets").val(),b=i.find(".redux-typography-color").val(),_=i.data("units"),!0===B?(d=redux.field_objects.typography.makeBool(I["data-google"]),i.find(".redux-typography-google-font").val(d)):d=redux.field_objects.typography.makeBool(i.find(".redux-typography-google-font").val()),s&&(i.hasClass("typography-initialized")||(v=i.find("select.redux-typography-style").data("value"),m=i.find("select.redux-typography-subsets").data("value"),""!==v&&(v=String(v)),m=String(m)),void 0===redux.optName.fonts.google&&(d=!1),k=!0===d&&p in redux.optName.fonts.google?redux.optName.fonts.google[p]:void 0!==redux.optName.fonts.typekit&&p in redux.optName.fonts.typekit?(w=!0,redux.optName.fonts.typekit[p]):{400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},O(e).hasClass("redux-typography-subsets")&&i.find("input.typography-subsets").val(m),O(e).hasClass("redux-typography-family")?(!0===d?(O.each(k.variants,function(e,t){t.id===v||1===redux.field_objects.typography.size(k.variants)?(z=' selected="selected"',v=t.id):z="",N+='<option value="'+t.id+'"'+z+">"+t.name.replace(/\+/g," ")+"</option>"}),a&&i.find(".redux-typography-style").select2("destroy"),i.find(".redux-typography-style").html(N).select2(),z="",N='<option value=""></option>',O.each(k.subsets,function(e,t){m===t.id||1===redux.field_objects.typography.size(k.subsets)?(z=' selected="selected"',m=t.id,i.find("input.typography-subsets").val(m)):z="",N+='<option value="'+t.id+'"'+z+">"+t.name.replace(/\+/g," ")+"</option>"}),a&&i.find(".redux-typography-subsets").select2("destroy"),i.find(".redux-typography-subsets").html(N).select2(),i.find(".redux-typography-subsets").parent().fadeIn("fast"),i.find(".typography-family-backup").fadeIn("fast")):!0===w?(O.each(k.variants,function(e,t){v===t.id||1===redux.field_objects.typography.size(k.variants)?(z=' selected="selected"',v=t.id):z="",N+='<option value="'+t.id+'"'+z+">"+t.name.replace(/\+/g," ")+"</option>"}),i.find(".redux-typography-style").select2("destroy"),i.find(".redux-typography-style").html(N).select2(),i.find(".redux-typography-subsets").parent().fadeOut("fast"),i.find(".typography-family-backup").fadeOut("fast")):k&&(O.each(k,function(e,t){v===e||"normal"===e?(z=' selected="selected"',i.find(".typography-style select2-selection__rendered").text(t)):z="",N+='<option value="'+e+'"'+z+">"+t.replace("+"," ")+"</option>"}),a&&i.find(".redux-typography-style").select2("destroy"),i.find(".redux-typography-style").html(N).select2(),i.find(".redux-typography-subsets").parent().fadeOut("fast"),i.find(".typography-family-backup").fadeOut("fast")),i.find(".redux-typography-font-family").val(p)):O(e).hasClass("redux-typography-family-backup")&&""!==n&&i.find(".redux-typography-font-family-backup").val(n)),s&&(i.find(".redux-typography-style").addClass("ignore-change"),0===i.find("select.redux-typography-style option[value='"+v+"']").length?(v="",i.find("select.redux-typography-style").val("").trigger("change")):"400"===v&&i.find("select.redux-typography-style").val(v).trigger("change"),i.find(".redux-typography-style").removeClass("ignore-change"),0===i.find("select.redux-typography-subsets option[value='"+m+"']").length&&(m="",i.find(".redux-typography-style").addClass("ignore-change"),i.find("select.redux-typography-subsets").val("").trigger("change"),i.find("input.typography-subsets").val(m),i.find(".redux-typography-style").removeClass("ignore-change"))),O("."+("style_link_"+o)).remove(),null!==p&&"inherit"!==p&&i.hasClass("typography-initialized")&&(C=p.replace(/\s+/g,"+"),!0===d?(j=C,v&&""!==v&&(j+=":"+v.replace(/\-/g," ")),m&&""!==m&&(j+="&subset="+m),!1===B&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[j]}}),i.find(".redux-typography-google").val(!0)):i.find(".redux-typography-google").val(!1)),-1!==v.indexOf("italic")?(i.find(".typography-preview").css("font-style","italic"),i.find(".typography-font-style").val("italic"),v=v.replace("italic","")):(i.find(".typography-preview").css("font-style","normal"),i.find(".typography-font-style").val("")),i.find(".typography-font-weight").val(v),Boolean(i.find(".redux-typography-height").data("allow-empty"))||(l=l||y),""===y||void 0===y?i.find(".typography-font-size").val(""):i.find(".typography-font-size").val(y+_),""===l||void 0===l?i.find(".typography-line-height").val(""):i.find(".typography-line-height").val(l+_),""===g||void 0===g?i.find(".typography-word-spacing").val(""):i.find(".typography-word-spacing").val(g+_),""===h||void 0===h?i.find(".typography-letter-spacing").val(""):i.find(".typography-letter-spacing").val(h+_),P&&redux.field_objects.pro.typography.select(o),i.hasClass("typography-initialized")&&(0===i.find(".typography-preview").data("preview-size")&&i.find(".typography-preview").css("font-size",y+_),i.find(".typography-preview").css({"font-weight":v,"text-align":u,"font-family":p+", sans-serif"}),"none"===p&&""===p&&i.find(".typography-preview").css("font-family","inherit"),i.find(".typography-preview").css({"line-height":l+_,"word-spacing":g+_,"letter-spacing":h+_}),b&&i.find(".typography-preview").css("color",b),P&&redux.field_objects.typography.previewShadow(o),i.find(".typography-style select2-selection__rendered").text(i.find(".redux-typography-style option:selected").text()),i.find(".typography-script select2-selection__rendered").text(i.find(".redux-typography-subsets option:selected").text()),u&&i.find(".typography-preview").css("text-align",u),f&&i.find(".typography-preview").css("text-transform",f),c&&i.find(".typography-preview").css("font-variant",c),x&&i.find(".typography-preview").css("text-decoration",x),i.find(".typography-preview").slideDown()),i.hasClass("typography-initialized")||i.addClass("typography-initialized"),B=!1,t||redux_change(e)}}(jQuery);